<nav class="navbar navbar-expand-md navbar-dark fixed-top fixed-top" id="mainmenu">
    <div class="container">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                data-target="#navbar" aria-controls="navbar" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a href="/" class="navbar-brand" title="Одиссей - поставщик промышленного оборудования">
            <div class="logo">
                <div class="logo__sign">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 83.3 83.3">
                        <path d="M46.1 83.3l37.1-41.4L44.8 0H31.2L3.1 24.5l39.1 36.2L58 43.4 35 19.8l-8.9 8.7 16.2 15.9 2.1-2.1L32.1 30l3.1-3.2 15.5 16-7.6 8.2-23.7-22.5 16-15.6.1.1.1-.1L63.9 43C56.4 51.7 49 60.3 41.8 69L0 30v28.7l30.6 24.5h15.5z"/>
                    </svg>
                </div>
                <div class="logo__title">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 227.5 75.8">
                        <path d="M94.1 23.6h7.8v31h-7.7V39.4c-.3.1-.4.2-.5.3-2.3 1.8-4.6 3.5-6.9 5.2-.6.4-.8.9-.7 1.6v8h-7.8v-31h7.8v14.4c.6-.5 1.1-.8 1.6-1.2 2-1.6 4.1-3.1 6.1-4.7.3-.2.5-.6.5-1v-6.7c-.2-.1-.2-.4-.2-.7zm-18 24.6v6.4h-28c0-2.1.1-6.4.1-6.3 1 .1 1.2-.4 1.5-1.2 2-7.6 4.1-15.1 6.2-22.7.2-.7.5-.8 1.1-.8h10.2c.7 0 .9.2 1.1.9 2.1 7.6 4.2 15.2 6.2 22.8.2.8.7 1.1 1.6.9zm-9.2 0v-.4C65.4 41.9 64 35.9 62.6 30c-.1-.2-.4-.4-.6-.6-.2.2-.5.4-.5.6-1.1 4.4-2.1 8.8-3.2 13.2-.4 1.6-.8 3.3-1.2 4.9 3.4.1 6.5.1 9.8.1zM22.5 39c-.1-3.3.4-6.5 1.9-9.6 2.1-4.4 6.6-6.8 11.4-6.8 6.5.1 11 4.5 12.3 11.1.8 4.2.8 8.4-.4 12.5-1.4 4.6-4.1 7.9-8.9 9-7.1 1.6-13.1-1.7-15.3-9-.8-2.3-1-4.7-1-7.2zm17.8-2.3c-.1-2-.2-4.1-1.2-5.9-1.5-2.7-5.5-2.7-7 0-.5 1-1 2.2-1 3.3-.2 3.1-.2 6.3-.1 9.4 0 1.2.4 2.5.9 3.6 1.4 2.9 5.3 3.2 7.2.5.4-.6.8-1.4.9-2.1.1-2.3.3-8.2.3-8.8zm108.5 5.6h8.1c-.1 2.4-.6 4.6-1.6 6.7-1.9 4.2-5.4 6.2-9.8 6.5-3.1.2-6.1-.3-8.7-2.1-2.5-1.8-4-4.4-4.8-7.3-1.3-5-1.3-10.1.4-15.1 1.9-5.6 6.2-8.5 12.2-8.3 3 .1 5.8.9 8.1 3 2.3 2.2 3.3 4.9 3.7 8 .1.7.1 1.4.2 2.1-.4 0-.6 0-.9.1h-6.3c-.8 0-.9-.3-1-.9 0-.9-.1-1.9-.3-2.8-.4-1.8-1.9-3.2-3.5-3.3-2.1-.1-3.8.8-4.4 2.7-.4 1.1-.7 2.3-.7 3.5-.2 3.3-.3 6.6.2 9.8.3 1.7 1 3.3 2.7 4.1 2.7 1.2 5.5-.6 6-3.7.2-1 .3-2 .4-3zm-27.5 0h8.1c0 1.8-.4 3.5-.9 5.2-2 6.1-6.9 8.4-12.6 8-6.3-.4-9.9-4.2-11.3-9.9-1.3-5.4-1.2-10.7.9-15.8 2-4.8 6.3-7.3 11.5-7.1 3 .1 5.8.8 8.1 2.9 2.4 2.2 3.4 5.1 3.9 8.2.1.6.1 1.3.2 2-.3 0-.5.1-.7.1h-6.6c-.6 0-.7-.2-.8-.8 0-1-.1-2-.3-3-.4-1.8-1.8-3.2-3.4-3.3-2.1-.2-3.8.7-4.5 2.6-.4 1.2-.7 2.4-.8 3.6-.2 3.3-.3 6.6.2 9.9.3 1.8 1.1 3.5 3 4.2 2.7 1 5.3-.8 5.7-3.9.2-1 .3-1.9.3-2.9zm37.1 12.3v-31h20.1v6.1h-12.3v6.2H178v6h-11.8v6.5h12.5v6.3c-6.8-.1-13.5-.1-20.3-.1zm46.3 0h-7.8V39.3c-.9.7-5.8 4.4-7.4 5.7-.5.4-.7.8-.7 1.4v8.2H181v-31h7.8V38c.8-.6 5.8-4.4 7.6-5.8.5-.3.6-.7.6-1.3v-4.8h7.8c-.1 10.5-.1 18.1-.1 28.5z"/>
                        <path d="M204.9 18.2c-.9 3.5-4.2 6.3-8.3 6.3-4.2 0-7.4-3-8.2-6.3h5c.2 0 .5.3.6.5.7 1.4 1.8 1.6 2.8 1.6.9 0 2-.2 2.7-1.6.1-.2.4-.5.7-.5h4.7z"/>
                    </svg>
                </div>
            </div>
        </a>
        <div class="collapse navbar-collapse" id="navbar">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a href="/catalog" class="nav-link dropdown-toggle {if ($controller === 'catalog')}active{/if}"
                       id="navbarCatalogDropdown"
                       aria-haspopup="true"
                       aria-expanded="false">
                        Каталог
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link {if ($controller === 'feed')}active{/if}" href="/feed/">Новости</a>
                </li>
                <li class="nav-item">
                    <a href="/about/" class="nav-link {if ($controller === 'about')}active{/if}">О компании</a>
                </li>
                <li class="nav-item">
                    <a href="/info" class="nav-link dropdown-toggle {if ($controller === 'info')}active{/if}"
                       id="navbarInfoDropdown"
                       aria-haspopup="true"
                       aria-expanded="false">
                        Услуги
                    </a>

                </li>
                <li class="nav-item mr-auto">
                    <a href="/contacts/" class="nav-link {if ($controller === 'contacts')}active{/if}">Контакты</a>
                </li>
            </ul>
            <div class="navbar-text phone d-sm-none d-md-none d-xl-inline d-lg-inline">
                <span class="d-sm-none d-md-none d-lg-none d-xl-inline">Телефон в Ростове-на-Дону</span> <a
                        href="tel:+78632414848">+7 (863) <span class="number">241-48-48</span></a>
                <button href="#" class="btn btn-sm btn-primary callback-call" data-toggle="modal"
                        data-target="#callbackModal" id="callbackButton">
                    <i class="icon-phone"></i>
                    Позвоните мне!
                </button>
            </div>
        </div>
    </div>
    <div class="megamenu" aria-labelledby="navbarCatalogDropdown">
        <div class="container pt-3 pb-3">
            <div class="row pb-3">
                <div class="col megamenu__links">
                    <a href="/promo/" class="navbar-text promo">Акции</a>
                    <a href="/catalog/" class="navbar-text">Весь каталог</a>
                    <a href="/catalog/commission/" class="navbar-text">Коммиссионный отдел</a>
                </div>
            </div>
            <div class="megamenu__container">
                {section name="id" loop="$menucat"}
                    <a href="/catalog/{$menucat[id].id}-{$menucat[id].title|transliterate|lower}/"
                       class="megamenu__item"
                       title="{$menucat[id].title}"><span class="text-truncate">{$menucat[id].title} <small>({$menucat[id].items_count})</small></span>
                    </a>
                {/section}
            </div>
        </div>
    </div>

    <div class="megainfo" aria-labelledby="navbarInfoDropdown">
        <div class="container pt-3 pb-3">
            <div class="megainfo__container">

                <div class="megainfo__group">
                    <h4>Услуги</h4>
                    <a href="/service/center" class="megainfo__item" title="">Сервисный центр</a>
                    <a href="/service/delivery" class="megainfo__item" title="">Доставка, транспортные услуги</a>
                    <a href="/service/projects" class="megainfo__item" title="">Проектирование</a>
                </div>

                <div class="megainfo__group">
                    <h4>Информация</h4>
                    <a href="/info/credit" class="megainfo__item" title="">Кредит</a>
                    <a href="/info/payment" class="megainfo__item" title="">Оплата</a>
                    <a href="/info/moneyback" class="megainfo__item" title="">Возврат</a>
                </div>
                <div class="megainfo__group">
                    <h4>&nbsp;</h4>
                    <a href="/info/guarantee" class="megainfo__item" title="">Гарантии</a>
                    <a href="/info/certificates" class="megainfo__item" title="">Сертификаты</a>
                    <a href="/info/privacy" class="megainfo__item" title="">Конфидециальность</a>
                </div>

            </div>
        </div>
    </div>
</nav>

{include file="partials/callback-modal.tpl"}

<script>{literal}
	jQuery(function ($) {
		$('#navbarCatalogDropdown').on('mouseover', () => {
			$('.megamenu').addClass('active');
			$('.megainfo').removeClass('active')
		});
		$('#navbarInfoDropdown').on('mouseover', () => {
			$('.megainfo').addClass('active');
			$('.megamenu').removeClass('active');
		});

		$('#mainmenu').on('mouseleave', (e) => {
			if ($(e.currentTarget).parents('#mainmenu').length == 0) {
				$('.megamenu, .megainfo').removeClass('active');
			}
		});


		$('#phoneMask').inputmask("+7(999)999-99-99")

		$('#callbackForm').on('submit', function (e) {
			e.preventDefault();
			const data = $(this).serialize();
			const form = this;
			const btn = $('#callbackSubmit');
			const cbButton = $('#callbackButton');
			$('fieldset', form).prop('disabled', true);
			btn.data('text', btn.text())
				.html("<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> Loading...");
			$.post('/callbacks', data, function (response) {
				cbButton.popover({
					'placement': 'bottom',
					'content': (response && response.success)
						? '<h5>Ваша заявка принята</h5>Наш специалист свяжется с Вами в ближайшее, удобное для Вас время.'
						: '<h5>Ошибка</h5>При оформлении заявки возникли проблемы. Попробуйте воспользоваться функцией обратного звонка немного позже.',
					'html': true
				});
				cbButton.popover('show');
				setTimeout(function () {
					cbButton.popover('dispose');
				}, 6000);
			}).always(function () {
				$('fieldset', form).prop('disabled', false);
				btn.text(btn.data('text'));
				form.reset();
				$('#callbackModal').modal('hide')
			})
		})
	});
    {/literal}
</script>
